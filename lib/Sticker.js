/* Copyright (C) 2020 INrlTeam.

Licensed under the  GPL-3.0 License;

you may not use this file except in compliance with the License.

inrl-md

*/
function _0x106c(_0x85ec7,_0x4873fe){const _0x2831ea=_0x2831();return _0x106c=function(_0x106cfb,_0x4c0ce7){_0x106cfb=_0x106cfb-0xad;let _0x9ba1de=_0x2831ea[_0x106cfb];return _0x9ba1de;},_0x106c(_0x85ec7,_0x4873fe);}const _0x249c09=_0x106c;(function(_0x1c09cd,_0x4e4ff2){const _0x961602=_0x106c,_0x19d751=_0x1c09cd();while(!![]){try{const _0x41378e=parseInt(_0x961602(0xad))/0x1+parseInt(_0x961602(0xc8))/0x2*(-parseInt(_0x961602(0xce))/0x3)+parseInt(_0x961602(0xcc))/0x4+-parseInt(_0x961602(0xc2))/0x5*(-parseInt(_0x961602(0xda))/0x6)+parseInt(_0x961602(0xd0))/0x7*(-parseInt(_0x961602(0xcb))/0x8)+parseInt(_0x961602(0xbb))/0x9*(-parseInt(_0x961602(0xb8))/0xa)+parseInt(_0x961602(0xb1))/0xb*(parseInt(_0x961602(0xb3))/0xc);if(_0x41378e===_0x4e4ff2)break;else _0x19d751['push'](_0x19d751['shift']());}catch(_0x5b44e0){_0x19d751['push'](_0x19d751['shift']());}}}(_0x2831,0xdeafa));const fs=require('fs'),{tmpdir}=require('os'),Crypto=require(_0x249c09(0xd4)),ff=require(_0x249c09(0xb4)),webp=require('node-webpmux'),path=require(_0x249c09(0xd2));async function imageToWebp(_0x3a862b){const _0x138602=_0x249c09,_0x56fb7e=path['join'](__dirname,'../media/'+Crypto[_0x138602(0xc6)](0x6)['readUIntLE'](0x0,0x6)[_0x138602(0xdd)](0x24)+_0x138602(0xc9)),_0x3aed29=path[_0x138602(0xdc)](__dirname,_0x138602(0xc5)+Crypto[_0x138602(0xc6)](0x6)[_0x138602(0xc7)](0x0,0x6)[_0x138602(0xdd)](0x24)+'.jpg');fs[_0x138602(0xbe)](_0x3aed29,_0x3a862b),await new Promise((_0x4ef6b6,_0x448df6)=>{const _0x245a53=_0x138602;ff(_0x3aed29)['on'](_0x245a53(0xb0),_0x448df6)['on']('end',()=>_0x4ef6b6(!![]))['addOutputOptions']([_0x245a53(0xbf),_0x245a53(0xcd),_0x245a53(0xc3),_0x245a53(0xd1)])[_0x245a53(0xb2)](_0x245a53(0xae))['save'](_0x56fb7e);});const _0x469327=fs[_0x138602(0xba)](_0x56fb7e);return fs[_0x138602(0xde)](_0x56fb7e),fs[_0x138602(0xde)](_0x3aed29),_0x469327;}async function videoToWebp(_0x5b431e){const _0x3e1209=_0x249c09,_0x36660a=path[_0x3e1209(0xdc)](tmpdir(),Crypto[_0x3e1209(0xc6)](0x6)['readUIntLE'](0x0,0x6)[_0x3e1209(0xdd)](0x24)+_0x3e1209(0xc9)),_0x4247d3=path[_0x3e1209(0xdc)](tmpdir(),Crypto[_0x3e1209(0xc6)](0x6)[_0x3e1209(0xc7)](0x0,0x6)[_0x3e1209(0xdd)](0x24)+'.mp4');fs[_0x3e1209(0xbe)](_0x4247d3,_0x5b431e),await new Promise((_0x476e5a,_0x89553)=>{const _0x35a857=_0x3e1209;ff(_0x4247d3)['on']('error',_0x89553)['on']('end',()=>_0x476e5a(!![]))[_0x35a857(0xdb)]([_0x35a857(0xbf),'libwebp',_0x35a857(0xc3),_0x35a857(0xd1)])['toFormat']('webp')[_0x35a857(0xb9)](_0x36660a);});const _0x110643=fs['readFileSync'](_0x36660a);return fs[_0x3e1209(0xde)](_0x36660a),fs[_0x3e1209(0xde)](_0x4247d3),_0x110643;}async function writeExifImg(_0x513126,_0x374e66){const _0x2c98fc=_0x249c09;let _0x2cac6a=await imageToWebp(_0x513126);const _0x660401=path['join'](tmpdir(),Crypto[_0x2c98fc(0xc6)](0x6)[_0x2c98fc(0xc7)](0x0,0x6)['toString'](0x24)+'.webp'),_0x2a3d33=path[_0x2c98fc(0xdc)](tmpdir(),Crypto['randomBytes'](0x6)[_0x2c98fc(0xc7)](0x0,0x6)[_0x2c98fc(0xdd)](0x24)+_0x2c98fc(0xc9));fs[_0x2c98fc(0xbe)](_0x660401,_0x2cac6a);if(_0x374e66['packname']||_0x374e66[_0x2c98fc(0xc4)]){const _0x40c95a=new webp[(_0x2c98fc(0xcf))](),_0x5e403a={'sticker-pack-id':'https://AiDarkEzio.github.io','sticker-pack-name':_0x374e66[_0x2c98fc(0xd6)],'sticker-pack-publisher':_0x374e66[_0x2c98fc(0xc4)],'emojis':_0x374e66[_0x2c98fc(0xca)]?_0x374e66[_0x2c98fc(0xca)]:['']},_0x3c751e=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x4e6d5d=Buffer[_0x2c98fc(0xbd)](JSON['stringify'](_0x5e403a),_0x2c98fc(0xb6)),_0x8cb455=Buffer['concat']([_0x3c751e,_0x4e6d5d]);return _0x8cb455[_0x2c98fc(0xc0)](_0x4e6d5d['length'],0xe,0x4),await _0x40c95a['load'](_0x660401),fs['unlinkSync'](_0x660401),_0x40c95a[_0x2c98fc(0xbc)]=_0x8cb455,await _0x40c95a['save'](_0x2a3d33),_0x2a3d33;}}async function writeExifVid(_0x44d73b,_0x5d2fa0){const _0x435145=_0x249c09;let _0x543f42=await videoToWebp(_0x44d73b);const _0x5cdb8f=path['join'](tmpdir(),Crypto[_0x435145(0xc6)](0x6)[_0x435145(0xc7)](0x0,0x6)['toString'](0x24)+_0x435145(0xc9)),_0x175c45=path['join'](tmpdir(),Crypto['randomBytes'](0x6)[_0x435145(0xc7)](0x0,0x6)[_0x435145(0xdd)](0x24)+_0x435145(0xc9));fs[_0x435145(0xbe)](_0x5cdb8f,_0x543f42);if(_0x5d2fa0[_0x435145(0xd6)]||_0x5d2fa0[_0x435145(0xc4)]){const _0x2ee770=new webp[(_0x435145(0xcf))](),_0x243a4e={'sticker-pack-id':_0x435145(0xd8),'sticker-pack-name':_0x5d2fa0[_0x435145(0xd6)],'sticker-pack-publisher':_0x5d2fa0[_0x435145(0xc4)],'emojis':_0x5d2fa0[_0x435145(0xca)]?_0x5d2fa0[_0x435145(0xca)]:['']},_0x21c121=Buffer[_0x435145(0xbd)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x47436f=Buffer[_0x435145(0xbd)](JSON[_0x435145(0xd7)](_0x243a4e),_0x435145(0xb6)),_0x1e55a8=Buffer[_0x435145(0xaf)]([_0x21c121,_0x47436f]);return _0x1e55a8['writeUIntLE'](_0x47436f[_0x435145(0xd5)],0xe,0x4),await _0x2ee770[_0x435145(0xd9)](_0x5cdb8f),fs[_0x435145(0xde)](_0x5cdb8f),_0x2ee770[_0x435145(0xbc)]=_0x1e55a8,await _0x2ee770[_0x435145(0xb9)](_0x175c45),_0x175c45;}}async function writeExif(_0x533374,_0x233d1a){const _0x24a477=_0x249c09;let _0x3290c5=/webp/[_0x24a477(0xd3)](_0x533374[_0x24a477(0xb7)])?_0x533374['data']:/image/[_0x24a477(0xd3)](_0x533374[_0x24a477(0xb7)])?await imageToWebp(_0x533374[_0x24a477(0xb5)]):/video/[_0x24a477(0xd3)](_0x533374[_0x24a477(0xb7)])?await videoToWebp(_0x533374['data']):'';const _0x1bcc91=path['join'](tmpdir(),Crypto[_0x24a477(0xc6)](0x6)[_0x24a477(0xc7)](0x0,0x6)['toString'](0x24)+_0x24a477(0xc9)),_0x1c6c33=path['join'](tmpdir(),Crypto[_0x24a477(0xc6)](0x6)[_0x24a477(0xc7)](0x0,0x6)['toString'](0x24)+_0x24a477(0xc9));fs[_0x24a477(0xbe)](_0x1bcc91,_0x3290c5);if(_0x233d1a['packname']||_0x233d1a[_0x24a477(0xc4)]){const _0x58db9e=new webp[(_0x24a477(0xcf))](),_0x12895b={'sticker-pack-id':_0x24a477(0xd8),'sticker-pack-name':_0x233d1a[_0x24a477(0xd6)],'sticker-pack-publisher':_0x233d1a[_0x24a477(0xc4)],'emojis':_0x233d1a[_0x24a477(0xca)]?_0x233d1a['categories']:['']},_0x14bd4f=Buffer[_0x24a477(0xbd)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x592520=Buffer[_0x24a477(0xbd)](JSON['stringify'](_0x12895b),_0x24a477(0xb6)),_0x1265e=Buffer[_0x24a477(0xaf)]([_0x14bd4f,_0x592520]);return _0x1265e[_0x24a477(0xc0)](_0x592520[_0x24a477(0xd5)],0xe,0x4),await _0x58db9e[_0x24a477(0xd9)](_0x1bcc91),fs['unlinkSync'](_0x1bcc91),_0x58db9e['exif']=_0x1265e,await _0x58db9e[_0x24a477(0xb9)](_0x1c6c33),_0x1c6c33;}}function _0x2831(){const _0xef2df5=['toFormat','12xIqvvO','fluent-ffmpeg','data','utf-8','mimetype','10UFDdaD','save','readFileSync','2310417BiQCKa','exif','from','writeFileSync','-vcodec','writeUIntLE','exports','7065tHAQSZ','-vf','author','../media/','randomBytes','readUIntLE','2AhRjVY','.webp','categories','40BagHfs','252728JCUHsx','libwebp','4674762tadmGh','Image','131397CXmGFs','scale=512:512:force_original_aspect_ratio=increase,fps=15,crop=512:512','path','test','crypto','length','packname','stringify','https://AiDarkEzio.github.io','load','7146xVZWvJ','addOutputOptions','join','toString','unlinkSync','552890XRbMzp','webp','concat','error','5741879WdyHEX'];_0x2831=function(){return _0xef2df5;};return _0x2831();}module[_0x249c09(0xc1)]={'imageToWebp':imageToWebp,'videoToWebp':videoToWebp,'writeExifImg':writeExifImg,'writeExifVid':writeExifVid,'writeExif':writeExif};
